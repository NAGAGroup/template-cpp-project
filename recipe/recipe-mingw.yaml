schema_version: 1

package:
  name: template-cpp-project
  version: "0.1.0"

source:
  path: ..

build:
  number: 0
  string: mingw_build
  script:
    - |
      # Set up compiler environment variables (MinGW GCC)
      set CC=%BUILD_PREFIX%\bin\gcc.exe
      set CXX=%BUILD_PREFIX%\bin\g++.exe
      
      # Set up build directories
      mkdir build
      cd build
      
      # Configure with CMake
      cmake .. ^
        -GNinja ^
        -DCMAKE_BUILD_TYPE=Release ^
        -DCMAKE_INSTALL_PREFIX=%PREFIX% ^
        -DCMAKE_CXX_STANDARD=17 ^
        -DCMAKE_CXX_FLAGS="/W4 /permissive- /utf-8" ^
        -DTEMPLATE_CPP_PROJECT_DEVELOPER_MODE=ON
      
      # Build
      cmake --build . --config Release
      
      # Install
      cmake --install . --config Release

requirements:
  build:
    # Build tools
    - cmake >=3.24,<4
    - ninja >=1.12.1,<2
    - ccache >=4.10.1,<5
    - pkg-config >=1.5.5,<2
    # MinGW GCC compiler for Windows
    - gcc_win-64 >=13.3.0,<13.4
    - gxx_win-64 >=13.3.0,<13.4
  host:
    - fmt >=11.0.2,<12
  run:
    - fmt >=11.0.2,<12

tests:
  - script:
      - template-cpp-project_test --version
    requirements:
      run:
        - catch2 >=3.7.1,<4
        - template-cpp-project
